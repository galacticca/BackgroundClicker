<Window x:Class="BackgroundClicker.Wpf.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:syswin="clr-namespace:System.Windows;assembly=PresentationFramework"
        Title="Non-Blocking Window Clicker" Height="690" Width="1100" MinWidth="950" MinHeight="550"
        Icon="assets/icon.ico"
        WindowStartupLocation="CenterScreen" WindowStyle="None"
        AllowsTransparency="True" Background="Transparent" ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <Style x:Key="HeaderLinkButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#11FFFFFF"/>
            <Setter Property="Foreground" Value="#CCFFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#22FFFFFF"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="25,6"/>
            <Setter Property="Margin" Value="15,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="15" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#22FFFFFF"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#00F2EA"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AnimatedButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#22FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#33FFFFFF"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="8" RenderTransformOrigin="0.5,0.5">
                            <Border.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                            </Border.RenderTransform>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#44FFFFFF"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#00F2EA"/>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.05" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.05" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.0" Duration="0:0:0.1"/>
                                            <DoubleAnimation Storyboard.TargetName="border" Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.0" Duration="0:0:0.1"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="InfoButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#88FFFFFF"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Width" Value="22"/>
            <Setter Property="Height" Value="22"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
            <Setter Property="ToolTipService.Placement" Value="Top"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="11">
                            <TextBlock Text="{TemplateBinding Content}"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#4400F2EA"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#10FFFFFF"/>
            <Setter Property="CornerRadius" Value="15"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="BorderBrush" Value="#22FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="ProfileComboBoxStyle" TargetType="ComboBox">
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="OverridesDefaultStyle" Value="True"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="Background" Value="#151515"/>
            <Setter Property="Foreground" Value="#00F2EA"/>
            <Setter Property="BorderBrush" Value="#262626"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4,3"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Border x:Name="Border"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="4">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>


                                    <ContentPresenter x:Name="ContentSite"
                                                      Margin="{TemplateBinding Padding}"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      Content="{TemplateBinding SelectionBoxItem}"
                                                      ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                      ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                      RecognizesAccessKey="True"/>


                                    <TextBox x:Name="PART_EditableTextBox"
                                             Margin="{TemplateBinding Padding}"
                                             VerticalAlignment="Center"
                                             HorizontalAlignment="Left"
                                             Background="#151515"
                                             Foreground="#00F2EA"
                                             BorderThickness="0"
                                             Padding="0"
                                             Text="{Binding Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource TemplatedParent}}"
                                             Visibility="Hidden"/>


                                    <ToggleButton x:Name="DropDownToggle"
                                                  Grid.Column="1"
                                                  Focusable="False"
                                                  ClickMode="Press"
                                                  Background="Transparent"
                                                  BorderThickness="0"
                                                  IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                                        <Path Data="M 0 0 L 4 4 L 8 0 Z"
                                              Fill="#00F2EA"
                                              Stretch="Uniform"
                                              Margin="6,0,6,0"
                                              VerticalAlignment="Center"/>
                                    </ToggleButton>
                                </Grid>
                            </Border>


                            <Popup x:Name="PART_Popup"
                                   Placement="Bottom"
                                   PlacementTarget="{Binding ElementName=DropDownToggle}"
                                   IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Border Margin="0,2,0,0"
                                        Background="#151515"
                                        BorderBrush="#262626"
                                        BorderThickness="1"
                                        CornerRadius="4">
                                    <ScrollViewer>
                                        <StackPanel IsItemsHost="True"
                                                    KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Border" Property="Opacity" Value="0.5"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#00F2EA"/>
                            </Trigger>
                            <Trigger Property="IsDropDownOpen" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#00F2EA"/>
                            </Trigger>
                            <Trigger Property="IsEditable" Value="True">
                                <Setter TargetName="ContentSite" Property="Visibility" Value="Hidden"/>
                                <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="#15FFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#66FFFFFF"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="CaretBrush" Value="#00F2EA"/>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#BBFFFFFF"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Border CornerRadius="20" BorderThickness="1" BorderBrush="#44FFFFFF">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0F2027" Offset="0"/>
                <GradientStop Color="#203A43" Offset="0.5"/>
                <GradientStop Color="#2C5364" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="50"/> 
                <RowDefinition Height="*"/>   
                <RowDefinition Height="40"/>  
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Background="Transparent" MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Border Background="#11FFFFFF" CornerRadius="20,20,0,0"/>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                    <Border Width="10" Height="10" CornerRadius="5" Background="#00F2EA" Margin="0,0,10,0">
                        <Border.Effect>
                            <BlurEffect Radius="4"/>
                        </Border.Effect>
                    </Border>
                    <TextBlock Text="NON-BLOCKING WINDOW CLICKER" FontWeight="SemiBold" Foreground="White" Opacity="0.9" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Button Content="Help" Style="{StaticResource HeaderLinkButtonStyle}" Click="HelpButton_Click"/>
                    <Button Content="Credits" Style="{StaticResource HeaderLinkButtonStyle}" Click="CreditsButton_Click"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,15,0">
                    <Button Content="-" Width="30" Height="30" Click="MinimizeButton_Click" Style="{StaticResource AnimatedButtonStyle}" Margin="0,0,5,0" Background="Transparent" BorderThickness="0"/>
                    <Button Content="X" Width="30" Height="30" Click="CloseButton_Click" Style="{StaticResource AnimatedButtonStyle}" Background="#CCFF0055" BorderThickness="0" FontWeight="Bold"/>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" Margin="20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                    <TextBlock Text="TARGET CONFIGURATION" Foreground="#88FFFFFF" FontSize="10" FontWeight="Bold" Margin="0,0,0,10"/>
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Profile" Foreground="#AAFFFFFF" FontSize="11" Margin="0,0,0,4"/>
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <ComboBox x:Name="ProfileComboBox"
                                          Grid.Column="0"
                                          IsEditable="True"
                                          Height="30"
                                          Margin="0,0,5,0"
                                          Style="{StaticResource ProfileComboBoxStyle}"
                                          SelectionChanged="ProfileComboBox_SelectionChanged">
                                    <ComboBox.Resources>
                                        
                                        <SolidColorBrush x:Key="{x:Static syswin:SystemColors.WindowBrushKey}" Color="#151515" />
                                        <SolidColorBrush x:Key="{x:Static syswin:SystemColors.ControlBrushKey}" Color="#151515" />
                                        

                                        <Style x:Key="ComboBoxEditableTextBox" TargetType="TextBox">
                                            <Setter Property="Foreground" Value="#00F2EA"/>
                                            <Setter Property="Background" Value="#151515"/>
                                            <Setter Property="BorderThickness" Value="0"/>
                                            <Setter Property="Padding" Value="2,0,2,0"/>
                                        </Style>

                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="White"/>
                                        </Style>
                                    </ComboBox.Resources>
                                    <ComboBox.ItemContainerStyle>
                                        <Style TargetType="ComboBoxItem">
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="Background" Value="#151515"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsHighlighted" Value="True">
                                                    <Setter Property="Background" Value="#262626"/>
                                                </Trigger>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter Property="Background" Value="#00F2EA"/>
                                                    <Setter Property="Foreground" Value="#111111"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Button x:Name="SaveProfileButton" Content="Save" Width="55" Height="28" Margin="0,0,5,0"
                                            Style="{StaticResource AnimatedButtonStyle}"
                                            Click="SaveProfileButton_Click"/>
                                    <Button x:Name="DeleteProfileButton" Content="Del" Width="45" Height="28"
                                            Style="{StaticResource AnimatedButtonStyle}"
                                            Click="DeleteProfileButton_Click"/>
                                </StackPanel>
                            </Grid>

                            <TextBlock Text="Target Window Title" Foreground="#AAFFFFFF" FontSize="11" Margin="0,0,0,4"/>
                            <TextBox x:Name="WindowTitleTextBox" Height="30" FontSize="13"/>
                            
                            <Grid Margin="0,15,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                    <TextBlock Text="X Coordinate" Foreground="#AAFFFFFF" FontSize="11"/>
                                    <TextBox x:Name="XCoordTextBox" Height="30" HorizontalContentAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                    <TextBlock Text="Y Coordinate" Foreground="#AAFFFFFF" FontSize="11"/>
                                    <TextBox x:Name="YCoordTextBox" Height="30" HorizontalContentAlignment="Center"/>
                                </StackPanel>
                            </Grid>

                            <TextBlock Text="SEQUENCE (Steps)" Foreground="#88FFFFFF" FontSize="10" FontWeight="Bold" Margin="0,20,0,4"/>
                            <Border Background="#08FFFFFF" CornerRadius="8" BorderBrush="#22FFFFFF" BorderThickness="1" Padding="6" Margin="0,0,0,10">
                                <StackPanel>
                                    <ListBox x:Name="SequenceListBox" Height="95" BorderThickness="0" MouseDoubleClick="SequenceListBox_MouseDoubleClick">
                                        <ListBox.Style>
                                            <Style TargetType="ListBox">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ListBox">
                                                            <Border x:Name="Bd"
                                                                    Background="{TemplateBinding Background}"
                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                                    SnapsToDevicePixels="true">
                                                                <ScrollViewer Focusable="false" Padding="{TemplateBinding Padding}" Background="Transparent">
                                                                    <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                                </ScrollViewer>
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsEnabled" Value="false">
                                                                    <Setter TargetName="Bd" Property="Background" Value="#05FFFFFF" />
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ListBox.Style>
                                        <ListBox.ItemContainerStyle>
                                            <Style TargetType="ListBoxItem">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="Foreground" Value="#DDFFFFFF"/>
                                                <Setter Property="Padding" Value="3"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ListBoxItem">
                                                            <Border x:Name="Bd" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" CornerRadius="3" SnapsToDevicePixels="true">
                                                                <ContentPresenter />
                                                            </Border>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsSelected" Value="true">
                                                                    <Setter TargetName="Bd" Property="Background" Value="#4400F2EA"/>
                                                                    <Setter Property="Foreground" Value="White"/>
                                                                </Trigger>
                                                                <Trigger Property="IsEnabled" Value="false">
                                                                    <Setter Property="Foreground" Value="#88FFFFFF"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ListBox.ItemContainerStyle>
                                    </ListBox>
                                    <Grid Margin="0,5,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                                            <TextBlock Text="Delay after (s)" Foreground="#AAFFFFFF" FontSize="11" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                            <TextBox x:Name="SequenceDelayTextBox" Width="60" Height="28" HorizontalContentAlignment="Center" Text="1.0"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <Button x:Name="AddSequenceStepButton" Content="Add step" Width="70" Height="26" Margin="0,0,5,0"
                                                    Style="{StaticResource AnimatedButtonStyle}"
                                                    Click="AddSequenceStepButton_Click"/>
                                            <Button x:Name="RemoveSequenceStepButton" Content="Remove" Width="70" Height="26"
                                                    Style="{StaticResource AnimatedButtonStyle}"
                                                    Click="RemoveSequenceStepButton_Click"/>
                                            <Button x:Name="ClearSequenceButton" Content="Clear" Width="60" Height="26" Margin="5,0,0,0"
                                                    Style="{StaticResource AnimatedButtonStyle}"
                                                    Click="ClearSequenceButton_Click"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBlock Text="Use the main 'Start Setup' button to capture a position, then click 'Add step'." 
                                               Foreground="#88FFFFFF" FontSize="10" TextWrapping="Wrap" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>

                            <Separator Background="#33FFFFFF" Margin="0,20,0,20"/>
                            <Button x:Name="ListWindowsButton" Content="List Visible Windows" 
                                    Height="35" Click="ListWindowsButton_Click" Style="{StaticResource AnimatedButtonStyle}"
                                    Background="#3377AA" BorderBrush="#5599CC" Foreground="White" Margin="0,0,0,10"/>
                            <Button x:Name="AutoSetupButton" Content="Start Setup (Hold 3s)" 
                                    Height="45" Click="AutoSetupButton_Click" Style="{StaticResource AnimatedButtonStyle}"
                                    Background="#2200F2EA" BorderBrush="#00F2EA" Foreground="#00F2EA" FontWeight="Bold"/>
                            <TextBlock Text="Use 'List' to find the exact window title, then use 'Setup' to capture." 
                                       Foreground="#88FFFFFF" FontSize="10" TextWrapping="Wrap" Margin="0,8,0,0"
                                       HorizontalAlignment="Center" TextAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                    <TextBlock Text="AUTOMATION LOGIC" Foreground="#88FFFFFF" FontSize="10" FontWeight="Bold" Margin="0,0,0,10"/>
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="Interval (Seconds)" Foreground="#AAFFFFFF" FontSize="11"/>
                            <Grid Margin="0,5,0,5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="IntervalTextBox" Text="1.0" Height="30"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="10,0,0,0">
                                    <Button Content=".1s" Width="30" Height="25" Click="IntervalPreset_Click" Tag="0.1" Style="{StaticResource AnimatedButtonStyle}" Margin="0,0,5,0"/>
                                    <Button Content="1s" Width="30" Height="25" Click="IntervalPreset_Click" Tag="1.0" Style="{StaticResource AnimatedButtonStyle}"/>
                                </StackPanel>
                            </Grid>

                            <CheckBox x:Name="RandomizeIntervalCheckBox" Content="Randomize interval (±20%)" Margin="0,0,0,10"/>

                            <Grid Margin="0,0,0,2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                    <TextBlock Text="Stop after X clicks" Foreground="#AAFFFFFF" FontSize="11"/>
                                    <TextBox x:Name="StopAfterClicksTextBox" Height="26" HorizontalContentAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                    <TextBlock Text="Stop after minutes" Foreground="#AAFFFFFF" FontSize="11"/>
                                    <TextBox x:Name="StopAfterMinutesTextBox" Height="26" HorizontalContentAlignment="Center"/>
                                </StackPanel>
                            </Grid>
                            <CheckBox x:Name="HardStopCheckBox" Content="Stop immediately (hard limit)" Margin="0,0,0,10"/>

                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                    <TextBlock Text="Click jitter (pixels)" Foreground="#AAFFFFFF" FontSize="11"/>
                                    <TextBox x:Name="JitterPixelsTextBox" Height="26" HorizontalContentAlignment="Center" Text="0"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="5,0,0,0" VerticalAlignment="Center">
                                    <CheckBox x:Name="PlayClickSoundCheckBox" Content="Ping on click" Margin="0,0,0,4"/>
                                    <CheckBox x:Name="PlayErrorSoundCheckBox" Content="Alert on error/stop"/>
                                </StackPanel>
                            </Grid>

                            <CheckBox x:Name="DoubleClickCheckBox" Content="Send Double Click" Margin="0,0,0,10"/>
                            <CheckBox x:Name="AlwaysOnTopCheckBox" Content="Keep On Top" Checked="AlwaysOnTopCheckBox_CheckedChanged" Unchecked="AlwaysOnTopCheckBox_CheckedChanged" Margin="0,0,0,10"/>
                            
                            <CheckBox x:Name="UseSequenceCheckBox" Content="Use sequence instead of single target" Margin="0,0,0,10"/>
                            <CheckBox x:Name="BlockingClickCheckBox" Content="Use Blocking Clicking (takes control of mouse)" Margin="0,0,0,10">
                                <CheckBox.ToolTip>
                                    <ToolTip>
                                        Uses the real mouse cursor to perform clicks.
                                        This is more reliable for games or apps that ignore background clicks,
                                        but it will temporarily move your mouse.
                                    </ToolTip>
                                </CheckBox.ToolTip>
                            </CheckBox>

                            <Separator Background="#33FFFFFF" Margin="0,10,0,20"/>
                            <CheckBox x:Name="EnableAutoRepeatCheckBox" Content="Enable Auto-Repeat"
                                      FontSize="14" FontWeight="Bold" Foreground="White"
                                      Margin="0,0,0,15"/>
                            <Button x:Name="ExecutionButton" Content="START" Click="ExecutionButton_Click"
                                    Height="50" Style="{StaticResource AnimatedButtonStyle}"
                                    Background="#228B22" BorderBrush="#3CB371" FontWeight="Bold" FontSize="14"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>

            <Border Grid.Row="2" Background="#15000000" CornerRadius="0,0,20,20" Padding="20,0">
                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="v0.9.1 BETA" Foreground="#66FFFFFF" FontSize="10" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="STATUS:" Foreground="#66FFFFFF" FontSize="11" FontWeight="Bold"/>
                        <TextBlock x:Name="StatusTextBlock" Text="Idle" Foreground="#00F2EA" FontSize="11" Margin="5,0,0,0"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBlock x:Name="ClickCountTextBlock" Text="0" Foreground="White" FontWeight="Bold" FontSize="11" VerticalAlignment="Center"/>
                        <TextBlock Text=" clicks sent" Foreground="#66FFFFFF" FontSize="11" VerticalAlignment="Center"/>
                        <Button x:Name="ResetButton" Content="↺" 
                                Click="ResetButton_Click" 
                                Style="{StaticResource AnimatedButtonStyle}"
                                Width="25" Height="25" Margin="5,0,0,0" Padding="0"
                                Background="Transparent" BorderThickness="0"
                                FontSize="14" FontWeight="Bold" Foreground="#88FFFFFF"/>
                    </StackPanel>
                </Grid>
            </Border>

            
            <TextBlock x:Name="BetaWatermarkTextBlock"
                       Text="BETA / MADE BY THEHOLYONEZ"
                       Grid.Row="1"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Margin="0,160,0,0"
                       FontSize="40"
                       FontWeight="Bold"
                       Foreground="#30FFFFFF"
                       IsHitTestVisible="False"
                       TextOptions.TextRenderingMode="ClearType"
                       Panel.ZIndex="999">
                <TextBlock.RenderTransform>
                    <RotateTransform Angle="-35" />
                </TextBlock.RenderTransform>
            </TextBlock>
        </Grid>
    </Border>
</Window>
